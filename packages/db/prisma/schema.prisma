// packages/db/schema.prisma
generator client {
  provider = "prisma-client-js"
  output   = "../../node_modules/.pnpm/@prisma+client@latest/node_modules/@prisma/client"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model User {
  id        String   @id @default(cuid())
  email     String   @unique
  role      String   @default("user")
  createdAt DateTime @default(now())
  orders    Order[]
}

model Order {
  id        String   @id @default(cuid())
  service   String
  userId    String
  user      User     @relation(fields: [userId], references: [id])
  data      Json
  status    String   @default("pending")
  createdAt DateTime @default(now())
}

model StarsExchange {
  id           String   @id @default(cuid())
  telegramId   String
  username     String?
  starsAmount  Int
  payoutType   String   // 'TON' | 'USDT_TRC20' | 'IRR' | 'EUR'
  payoutInfo   String   // wallet address or IBAN
  status       String   // 'pending' | 'verified' | 'paid' | 'failed'
  reference    String   @unique
  createdAt    DateTime @default(now())
  updatedAt    DateTime @updatedAt
}
model UserWallet {
  id         String   @id @default(cuid())
  telegramId String   @unique
  username   String?
  tonAddress String?
  usdtAddress String?
  verified   Boolean  @default(false)
  createdAt  DateTime @default(now())
}
